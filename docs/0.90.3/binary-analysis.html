<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Binary Analysis · Archives Unleashed Toolkit</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Extract Audio Information"/><meta name="docsearch:version" content="0.90.3"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Binary Analysis · Archives Unleashed Toolkit"/><meta property="og:type" content="website"/><meta property="og:url" content="https://archivesunleashed.github.io/"/><meta property="og:description" content="## Extract Audio Information"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-2879197-28', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon.ico" alt="Archives Unleashed Toolkit"/><h2 class="headerTitleWithLogo">Archives Unleashed Toolkit</h2></a><a href="/versions"><h3>0.90.3</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/0.90.3/home" target="_self">Docs</a></li><li class=""><a href="https://archivesunleashed.org" target="_self">Project</a></li><li class=""><a href="https://github.com/archivesunleashed/aut" target="_self">GitHub</a></li><li class=""><a href="https://news.archivesunleashed.org/" target="_self">News</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Generating Results</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Home</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.90.3/home">The Toolkit</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.90.3/dependencies">Dependencies</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/usage">Usage</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/aut-at-scale">The Toolkit at Scale</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/dataframe-schemas">DataFrame Schemas</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/toolkit-walkthrough">Toolkit Walkthrough</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Generating Results</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.90.3/collection-analysis">Collection Analysis</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/text-analysis">Text Analysis</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/link-analysis">Link Analysis</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/image-analysis">Image Analysis</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/0.90.3/binary-analysis">Binary Analysis</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Filtering Results</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.90.3/filters-rdd">RDD Filters</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/filters-df">DataFrame Filters</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Standard Derivatives</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.90.3/aut-spark-submit-app">The Toolkit with spark-submit</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/auk-derivatives">AU Cloud Scholarly Derivatives</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/extract-binary-info">Extract Binary Info</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/extract-binary">Extract Binaries to Disk</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">What to do with Results</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/0.90.3/df-results">DataFrame Results</a></li><li class="navListItem"><a class="navItem" href="/docs/0.90.3/rdd-results">RDD Results</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Binary Analysis</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="extract-audio-information"></a><a href="#extract-audio-information" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extract Audio Information</h2>
<h3><a class="anchor" aria-hidden="true" id="scala-rdd"></a><a href="#scala-rdd" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala RDD</h3>
<p><strong>Will not be implemented.</strong></p>
<h3><a class="anchor" aria-hidden="true" id="scala-df"></a><a href="#scala-df" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).audio();

df.select($<span class="hljs-string">"url"</span>, $<span class="hljs-string">"filename"</span>, $<span class="hljs-string">"extension"</span>, $<span class="hljs-string">"mime_type_web_server"</span>, $<span class="hljs-string">"mime_type_tika"</span>, $<span class="hljs-string">"md5"</span>, $<span class="hljs-string">"sha1"</span>, $<span class="hljs-string">"bytes"</span>)
  .orderBy(desc(<span class="hljs-string">"md5"</span>))
  .show()
</code></pre>
<p>Will extract all following information from audio files in a web collection:</p>
<ul>
<li>audio url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+--------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+--------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    capasoligero.mp3</span>|<span class="hljs-string">      mp3</span>|<span class="hljs-string">          audio/mpeg</span>|<span class="hljs-string">    audio/mpeg</span>|<span class="hljs-string">fffd1aa802392be0f...</span>|<span class="hljs-string">88e254b4cab7848a9...</span>|<span class="hljs-string">//MozAAAAAAAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">        colorwnd.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">fff3f4e8a473f7c9a...</span>|<span class="hljs-string">aea92a6f32dd1a1f4...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAGA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">santana_rob_thoma...</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">ffd4a24d4e4722d94...</span>|<span class="hljs-string">28576c271898a1de5...</span>|<span class="hljs-string">TVRoZAAAAAYAAQASA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           music.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">ffcbe35e28b553481...</span>|<span class="hljs-string">cf1ebdbe1a070d4f6...</span>|<span class="hljs-string">TVRoZAAAAAYAAAABA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        evrythng.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">ff751c86728ff09b5...</span>|<span class="hljs-string">d22fc0911d3ceb17a...</span>|<span class="hljs-string">TVRoZAAAAAYAAAABA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        evrythn2.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">ff751c86728ff09b5...</span>|<span class="hljs-string">d22fc0911d3ceb17a...</span>|<span class="hljs-string">TVRoZAAAAAYAAAABA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          picket.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">ff4d225a602630584...</span>|<span class="hljs-string">ecef0a851cc028853...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAHA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        simpsons.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">ff3bc375860979f2f...</span>|<span class="hljs-string">9c1204dad686ddeea...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAPA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">        simpsons.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">ff3bc375860979f2f...</span>|<span class="hljs-string">9c1204dad686ddeea...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAPA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        mypretty.wav</span>|<span class="hljs-string">      wav</span>|<span class="hljs-string">         audio/x-wav</span>|<span class="hljs-string">audio/vnd.wave</span>|<span class="hljs-string">ff1a5015d3a380955...</span>|<span class="hljs-string">113de5c1bb2f7ddb4...</span>|<span class="hljs-string">UklGRvz8AABXQVZFZ...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          song37.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">fee0a67ff7c71e35c...</span>|<span class="hljs-string">ccd4fdfa0483d1058...</span>|<span class="hljs-string">TVRoZAAAAAYAAAABA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    holdyourhand.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">fed14ecd7099e3fb9...</span>|<span class="hljs-string">24fe5c097db5d506a...</span>|<span class="hljs-string">TVRoZAAAAAYAAQANA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    es_tu_sangre.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">fec196e8086d868f2...</span>|<span class="hljs-string">eccb1551d1e7b236e...</span>|<span class="hljs-string">TVRoZAAAAAYAAQASA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">          virgin.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">fec0ce795723b1287...</span>|<span class="hljs-string">cc651312b1d57fe64...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAMA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">tonibraxtonunbrea...</span>|<span class="hljs-string">      wav</span>|<span class="hljs-string">         audio/x-wav</span>|<span class="hljs-string">audio/vnd.wave</span>|<span class="hljs-string">feb7e31a8edb0a484...</span>|<span class="hljs-string">9420bdeece0f23b78...</span>|<span class="hljs-string">UklGRtQoCgBXQVZFZ...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      comeandsee.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">feb513cd7b6fab9cc...</span>|<span class="hljs-string">51b4c2bb113cb43aa...</span>|<span class="hljs-string">TVRoZAAAAAYAAAABA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        song186t.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">fead61a5a439675a3...</span>|<span class="hljs-string">c652eda8a4ec5d197...</span>|<span class="hljs-string">TVRoZAAAAAYAAAABA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    be_magnified.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">feac0e996e1555d84...</span>|<span class="hljs-string">f51ec1e62a166fa82...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAPA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        EVERYBOD.MID</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">fea911b19f0cf709d...</span>|<span class="hljs-string">58bcd1b3c0288cbe0...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAUA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">        ff9waltz.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">fe9eb1ea6d4b53a9f...</span>|<span class="hljs-string">72e2467bfea6240b8...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAKA...</span>|
+--------------------+--------------------+---------+--------------------+--------------+--------------------+--------------------+--------------------+
</code></pre>
<p>If you wanted to work with all the audio files in a collection, you could
extract them with the following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).audio();

df.select($<span class="hljs-string">"bytes"</span>, $<span class="hljs-string">"extension"</span>)
  .saveToDisk(<span class="hljs-string">"bytes"</span>, <span class="hljs-string">"/path/to/export/directory/your-preferred-filename-prefix"</span>, $<span class="hljs-string">"extension"</span>)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="python-df"></a><a href="#python-df" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *

archive = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>)

df = archive.audio()
df.show()
</code></pre>
<p>Will extract all following information from audio files in a web collection:</p>
<ul>
<li>audio url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+--------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+--------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">        hc-tibet.wav</span>|<span class="hljs-string">      wav</span>|<span class="hljs-string">         audio/x-wav</span>|<span class="hljs-string">audio/vnd.wave</span>|<span class="hljs-string">416ad26133f63dc3e...</span>|<span class="hljs-string">dfb764d759187d102...</span>|<span class="hljs-string">UklGRg6eAABXQVZFZ...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">bookmarkthissite.wav</span>|<span class="hljs-string">      wav</span>|<span class="hljs-string">         audio/x-wav</span>|<span class="hljs-string">audio/vnd.wave</span>|<span class="hljs-string">7897ff71780a903ca...</span>|<span class="hljs-string">cfb942aeb3bc881cd...</span>|<span class="hljs-string">UklGRppkAABXQVZFZ...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">   NeilYoung-Hey.mp3</span>|<span class="hljs-string">      mp3</span>|<span class="hljs-string">          audio/mpeg</span>|<span class="hljs-string">    audio/mpeg</span>|<span class="hljs-string">40869eb3181e6035b...</span>|<span class="hljs-string">19fa693521cd8125c...</span>|<span class="hljs-string">//uQRAAAAcAAsNUEA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          misty1.mp3</span>|<span class="hljs-string">      mp3</span>|<span class="hljs-string">          audio/mpeg</span>|<span class="hljs-string">    audio/mpeg</span>|<span class="hljs-string">d8cb3ce54072a7d4b...</span>|<span class="hljs-string">43b92e16932c13a43...</span>|<span class="hljs-string">//uQBAAAAsJl22mBE...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            sale.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">5dfc0c3dd884e50c7...</span>|<span class="hljs-string">071840b4822ae5e80...</span>|<span class="hljs-string">TVRoZAAAAAYAAQALA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        swaplink.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">f32117ce2bffa9902...</span>|<span class="hljs-string">0346223861c87acc1...</span>|<span class="hljs-string">TVRoZAAAAAYAAQALA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">              m5.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">7e5eedebafecd26c4...</span>|<span class="hljs-string">393dfbc00c49fcdc9...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAJA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          morder.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">6cec0785377f5bbaf...</span>|<span class="hljs-string">a94f0a75c0c3b3cf5...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAMA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">              m2.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">58b0102f997e689a2...</span>|<span class="hljs-string">51ad469ebc931e160...</span>|<span class="hljs-string">TVRoZAAAAAYAAQALA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           music.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">7917a5a9d6ddfb8dd...</span>|<span class="hljs-string">009db9df73cdf5247...</span>|<span class="hljs-string">TVRoZAAAAAYAAQALA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">        hcpopeye.wav</span>|<span class="hljs-string">      wav</span>|<span class="hljs-string">         audio/x-wav</span>|<span class="hljs-string">audio/vnd.wave</span>|<span class="hljs-string">04d7b45c70e0a496e...</span>|<span class="hljs-string">9db0e61c16554af88...</span>|<span class="hljs-string">UklGRrbAAABXQVZFZ...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">              m7.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">3906ecaba32ba15a8...</span>|<span class="hljs-string">e0d6e9f1c86b6204e...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAHA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           words.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">30da01a4ed42ae469...</span>|<span class="hljs-string">160b2e5aaa9b95641...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAIA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          brock5.mp3</span>|<span class="hljs-string">      mp3</span>|<span class="hljs-string">          audio/mpeg</span>|<span class="hljs-string">    audio/mpeg</span>|<span class="hljs-string">17f4e1c7a007983a5...</span>|<span class="hljs-string">3bbdb27fafa4e8b12...</span>|<span class="hljs-string">//MozAANkCLE/gjGA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          brock1.mp3</span>|<span class="hljs-string">      mp3</span>|<span class="hljs-string">          audio/mpeg</span>|<span class="hljs-string">    audio/mpeg</span>|<span class="hljs-string">67db65825afc326ed...</span>|<span class="hljs-string">2ec4ac110cff19134...</span>|<span class="hljs-string">//MozAAMyX7VmBjGl...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       funkytown.wav</span>|<span class="hljs-string">      wav</span>|<span class="hljs-string">         audio/x-wav</span>|<span class="hljs-string">audio/vnd.wave</span>|<span class="hljs-string">6f841bcffe4bbb61d...</span>|<span class="hljs-string">ab1fdb143d5752cf1...</span>|<span class="hljs-string">UklGRlLOCQBXQVZFZ...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">  welcomemyworld.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">c546eac675e2dd974...</span>|<span class="hljs-string">cb4f1fa32aa1e3205...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAMA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">        irisheye.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">d906f32953742fdef...</span>|<span class="hljs-string">f3ca7449483b0ea65...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAFA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       mission21.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">c507304afe6cddba1...</span>|<span class="hljs-string">72a74c1914044746f...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAVA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         tellit1.mid</span>|<span class="hljs-string">      mid</span>|<span class="hljs-string">          audio/midi</span>|<span class="hljs-string">    audio/midi</span>|<span class="hljs-string">a604ae85251d55504...</span>|<span class="hljs-string">95096668900a76dc8...</span>|<span class="hljs-string">TVRoZAAAAAYAAQAQA...</span>|
+--------------------+--------------------+---------+--------------------+--------------+--------------------+--------------------+--------------------+
only showing top 20 rows
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extract-image-information"></a><a href="#extract-image-information" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extract Image Information</h2>
<h3><a class="anchor" aria-hidden="true" id="scala-rdd-1"></a><a href="#scala-rdd-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala RDD</h3>
<p><strong>Will not be implemented.</strong></p>
<h3><a class="anchor" aria-hidden="true" id="scala-df-1"></a><a href="#scala-df-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).images();

df.select($<span class="hljs-string">"url"</span>, $<span class="hljs-string">"filename"</span>, $<span class="hljs-string">"extension"</span>, $<span class="hljs-string">"mime_type_web_server"</span>, $<span class="hljs-string">"mime_type_tika"</span>, $<span class="hljs-string">"width"</span>, $<span class="hljs-string">"height"</span>, $<span class="hljs-string">"md5"</span>, $<span class="hljs-string">"sha1"</span>, $<span class="hljs-string">"bytes"</span>)
  .orderBy(desc(<span class="hljs-string">"md5"</span>))
  .show()
</code></pre>
<p>Will extract all following information from images in a web collection:</p>
<ul>
<li>image url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>Width</li>
<li>Height</li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+--------------+-----+------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">mime_type_tika</span>|<span class="hljs-string">width</span>|<span class="hljs-string">height</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+--------------+-----+------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">mediatype_movies.gif</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">   21</span>|<span class="hljs-string">    21</span>|<span class="hljs-string">ff05f9b408519079c...</span>|<span class="hljs-string">194800d702aab9b87...</span>|<span class="hljs-string">R0lGODlhFQAVAKUpA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">    LOCLogoSmall.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  275</span>|<span class="hljs-string">   300</span>|<span class="hljs-string">fbf1aec668101b960...</span>|<span class="hljs-string">564c1a07152c12cea...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   archive.small.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  300</span>|<span class="hljs-string">   225</span>|<span class="hljs-string">f611b554b9a44757d...</span>|<span class="hljs-string">e9bf7ef0ae3fc50f5...</span>|<span class="hljs-string">/9j/4RpBRXhpZgAAT...</span>|
|<span class="hljs-string">http://tsunami.ar...</span>|<span class="hljs-string">  tsunamiweb1_02.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  384</span>|<span class="hljs-string">   229</span>|<span class="hljs-string">f02005e29ffb485ca...</span>|<span class="hljs-string">9eeb9c3c67d7efc51...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">alexa_websearch_l...</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">  301</span>|<span class="hljs-string">    47</span>|<span class="hljs-string">eecc909992272ce0d...</span>|<span class="hljs-string">ea18e226f3cf40005...</span>|<span class="hljs-string">R0lGODlhLQEvAPcAA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">      lizardtech.gif</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">  140</span>|<span class="hljs-string">    37</span>|<span class="hljs-string">e7166743861126e51...</span>|<span class="hljs-string">cf26e9ffc27be133f...</span>|<span class="hljs-string">R0lGODlhjAAlANUwA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">       half_star.png</span>|<span class="hljs-string">      png</span>|<span class="hljs-string">           image/png</span>|<span class="hljs-string">     image/png</span>|<span class="hljs-string">   14</span>|<span class="hljs-string">    12</span>|<span class="hljs-string">e1e101f116d9f8251...</span>|<span class="hljs-string">736abd06a978e2fd2...</span>|<span class="hljs-string">iVBORw0KGgoAAAANS...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">         hewlett.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  300</span>|<span class="hljs-string">   116</span>|<span class="hljs-string">e1da27028b81db60e...</span>|<span class="hljs-string">eb418c17901b1b313...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">prelinger-header-...</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">   84</span>|<span class="hljs-string">    72</span>|<span class="hljs-string">d39cce8b2f3aaa783...</span>|<span class="hljs-string">1c41a644123e8f861...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">           arrow.gif</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">   13</span>|<span class="hljs-string">    11</span>|<span class="hljs-string">c7ee6d7c17045495e...</span>|<span class="hljs-string">7013764e619066e60...</span>|<span class="hljs-string">R0lGODlhDQALALMAA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">          folder.png</span>|<span class="hljs-string">      png</span>|<span class="hljs-string">           image/png</span>|<span class="hljs-string">     image/png</span>|<span class="hljs-string">   20</span>|<span class="hljs-string">    15</span>|<span class="hljs-string">c1905fb5f16232525...</span>|<span class="hljs-string">ff7b8c60e8397cb5d...</span>|<span class="hljs-string">iVBORw0KGgoAAAANS...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">     wayback-wtc.gif</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">   35</span>|<span class="hljs-string">    35</span>|<span class="hljs-string">c15ec074d95fe7e1e...</span>|<span class="hljs-string">f45425406600b136d...</span>|<span class="hljs-string">R0lGODlhIwAjANUAA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">     clicktoplay.png</span>|<span class="hljs-string">      png</span>|<span class="hljs-string">           image/png</span>|<span class="hljs-string">     image/png</span>|<span class="hljs-string">  320</span>|<span class="hljs-string">   240</span>|<span class="hljs-string">b148d9544a1a65ae4...</span>|<span class="hljs-string">477105e3a93b60dd8...</span>|<span class="hljs-string">iVBORw0KGgoAAAANS...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">    orange_arrow.gif</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">    8</span>|<span class="hljs-string">    11</span>|<span class="hljs-string">a820ac93e2a000c9d...</span>|<span class="hljs-string">850b9daeef06bee6e...</span>|<span class="hljs-string">R0lGODlhCAALAJECA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">  arc-it-tagline.gif</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">  385</span>|<span class="hljs-string">    30</span>|<span class="hljs-string">9f70e6cc21ac55878...</span>|<span class="hljs-string">4601e2f642d8e55ac...</span>|<span class="hljs-string">R0lGODlhgQEeALMPA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">          guitar.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  140</span>|<span class="hljs-string">   171</span>|<span class="hljs-string">9ed163df5065418db...</span>|<span class="hljs-string">f6c9475009ae2416c...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">        blendbar.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string"> 1800</span>|<span class="hljs-string">    89</span>|<span class="hljs-string">9e41e4d6bdd53cd9d...</span>|<span class="hljs-string">dc780bf80720c87c9...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">alexalogo-archive...</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">  304</span>|<span class="hljs-string">    36</span>|<span class="hljs-string">9da73cf504be0eb70...</span>|<span class="hljs-string">03e530ef04e4b68f7...</span>|<span class="hljs-string">R0lGODlhMAEkAOYAA...</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">             lma.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  215</span>|<span class="hljs-string">    71</span>|<span class="hljs-string">97ebd3441323f9b5d...</span>|<span class="hljs-string">ff9485b26300721b2...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://i.creative...</span>|<span class="hljs-string">           88x31.png</span>|<span class="hljs-string">      png</span>|<span class="hljs-string">           image/png</span>|<span class="hljs-string">     image/png</span>|<span class="hljs-string">   88</span>|<span class="hljs-string">    31</span>|<span class="hljs-string">9772d34b683f8af83...</span>|<span class="hljs-string">689bef4ffb8918612...</span>|<span class="hljs-string">iVBORw0KGgoAAAANS...</span>|
+--------------------+--------------------+---------+--------------------+--------------+-----+------+--------------------+--------------------+--------------------+

only showing top 20 rows

import io.archivesunleashed._
import io.archivesunleashed.udfs._
df: org.apache.spark.sql.DataFrame = [url: string, filename: string ... 7 more fields]
</code></pre>
<p>If you wanted to work with all the images in a collection, you could extract
them with the following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.matchbox._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).images();

df.select($<span class="hljs-string">"bytes"</span>, $<span class="hljs-string">"extension"</span>)
  .saveToDisk(<span class="hljs-string">"bytes"</span>, <span class="hljs-string">"/path/to/export/directory/your-preferred-filename-prefix"</span>, $<span class="hljs-string">"extension"</span>)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="python-df-1"></a><a href="#python-df-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *

archive = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>)

df = archive.images()
df.show()
</code></pre>
<p>Will extract all following information from images in a web collection:</p>
<ul>
<li>image url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>Width</li>
<li>Height</li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+--------------+-----+------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">mime_type_tika</span>|<span class="hljs-string">width</span>|<span class="hljs-string">height</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+--------------+-----+------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://farm3.stat...</span>|<span class="hljs-string">4047878934_ef12ba...</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  100</span>|<span class="hljs-string">    75</span>|<span class="hljs-string">e1a376f170b815f49...</span>|<span class="hljs-string">2165fd2908950e9f6...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://farm3.stat...</span>|<span class="hljs-string">4047881126_fc6777...</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">   75</span>|<span class="hljs-string">   100</span>|<span class="hljs-string">371a2a5142c611405...</span>|<span class="hljs-string">933f937c949826696...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://farm3.stat...</span>|<span class="hljs-string">4047879492_a72dd8...</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  100</span>|<span class="hljs-string">    75</span>|<span class="hljs-string">8877679361cde970d...</span>|<span class="hljs-string">31dbaaed2f7194c95...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://farm3.stat...</span>|<span class="hljs-string">4047877728_c6c118...</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">   75</span>|<span class="hljs-string">   100</span>|<span class="hljs-string">8f009a568d47e1888...</span>|<span class="hljs-string">7b83e7d6c78ed65cf...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://img.youtub...</span>|<span class="hljs-string">               0.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  480</span>|<span class="hljs-string">   360</span>|<span class="hljs-string">96d9290d060547781...</span>|<span class="hljs-string">2d3005bd6e09ca064...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://img.youtub...</span>|<span class="hljs-string">               0.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  480</span>|<span class="hljs-string">   360</span>|<span class="hljs-string">c69d65d4880445b31...</span>|<span class="hljs-string">abe40cb96bfc79095...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://img.youtub...</span>|<span class="hljs-string">               0.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  480</span>|<span class="hljs-string">   360</span>|<span class="hljs-string">cb11c08d43e25ec3b...</span>|<span class="hljs-string">2060857d6cf41b141...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://img.youtub...</span>|<span class="hljs-string">               0.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  480</span>|<span class="hljs-string">   360</span>|<span class="hljs-string">756b5a0a83a621eb7...</span>|<span class="hljs-string">d4625efc80efb985e...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://img.youtub...</span>|<span class="hljs-string">               0.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  480</span>|<span class="hljs-string">   360</span>|<span class="hljs-string">0b60007c3e3d9d63f...</span>|<span class="hljs-string">a154035590a01efb4...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://img.youtub...</span>|<span class="hljs-string">               0.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  480</span>|<span class="hljs-string">   360</span>|<span class="hljs-string">97fdea388e1245691...</span>|<span class="hljs-string">e415a77a4369ecef8...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://img.youtub...</span>|<span class="hljs-string">               0.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  480</span>|<span class="hljs-string">   360</span>|<span class="hljs-string">05c2d43f687f40b60...</span>|<span class="hljs-string">ed3f6ca2f3d7e9569...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.canadi...</span>|<span class="hljs-string">     WebResource.axd</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">    1</span>|<span class="hljs-string">     1</span>|<span class="hljs-string">325472601571f31e1...</span>|<span class="hljs-string">2daeaa8b5f19f0bc2...</span>|<span class="hljs-string">R0lGODlhAQABAIAAA...</span>|
|<span class="hljs-string">http://www.davids...</span>|<span class="hljs-string">footprint-carbon.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  200</span>|<span class="hljs-string">   200</span>|<span class="hljs-string">51f57de92e76f3edc...</span>|<span class="hljs-string">c970137cd3bfdbbba...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.gca.ca...</span>|<span class="hljs-string">              15.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  300</span>|<span class="hljs-string">   230</span>|<span class="hljs-string">8b3c192b9a0cc82d6...</span>|<span class="hljs-string">851377ed11c9cd153...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.equalv...</span>|<span class="hljs-string">loadingAnimation.gif</span>|<span class="hljs-string">      gif</span>|<span class="hljs-string">           image/gif</span>|<span class="hljs-string">     image/gif</span>|<span class="hljs-string">  208</span>|<span class="hljs-string">    13</span>|<span class="hljs-string">c33734a1bf58bec32...</span>|<span class="hljs-string">2bb50e01775289c24...</span>|<span class="hljs-string">R0lGODlh0AANAMQAA...</span>|
|<span class="hljs-string">http://www.davids...</span>|<span class="hljs-string">Keep-greening-gre...</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  166</span>|<span class="hljs-string">   252</span>|<span class="hljs-string">4763383a8be13c735...</span>|<span class="hljs-string">a42b963e18dc1e7d4...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.davids...</span>|<span class="hljs-string">Keep-greening-don...</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  146</span>|<span class="hljs-string">   252</span>|<span class="hljs-string">515bd44bea759e169...</span>|<span class="hljs-string">75abeb65cc4f54c7d...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.davids...</span>|<span class="hljs-string">Keep-greening-eca...</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  158</span>|<span class="hljs-string">   252</span>|<span class="hljs-string">345f71df9702e99a0...</span>|<span class="hljs-string">b6637ac654f6e2073...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.davids...</span>|<span class="hljs-string">Keep-greening-tit...</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  470</span>|<span class="hljs-string">    45</span>|<span class="hljs-string">385522fde90ac7e96...</span>|<span class="hljs-string">b42151cf8c3ce14e0...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
|<span class="hljs-string">http://www.davids...</span>|<span class="hljs-string">    last_minute2.jpg</span>|<span class="hljs-string">      jpg</span>|<span class="hljs-string">          image/jpeg</span>|<span class="hljs-string">    image/jpeg</span>|<span class="hljs-string">  265</span>|<span class="hljs-string">    33</span>|<span class="hljs-string">3defee897d4c553fc...</span>|<span class="hljs-string">37c790bbc23c369d8...</span>|<span class="hljs-string">/9j/4AAQSkZJRgABA...</span>|
+--------------------+--------------------+---------+--------------------+--------------+-----+------+--------------------+--------------------+--------------------+
only showing top 20 rows
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extract-most-frequent-image-urls"></a><a href="#extract-most-frequent-image-urls" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extract Most Frequent Image URLs</h2>
<h3><a class="anchor" aria-hidden="true" id="scala-rdd-2"></a><a href="#scala-rdd-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala RDD</h3>
<p>The following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.matchbox._

<span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc)
  .keepValidPages()
  .flatMap(r =&gt; <span class="hljs-type">ExtractImageLinks</span>(r.getUrl, r.getContentString))
  .countItems()
  .take(<span class="hljs-number">10</span>)
</code></pre>
<p>Will extract the top ten URLs of images found within a collection, in an array
like so:</p>
<pre><code class="hljs css language-bash">links: Array[(String, Int)] = Array((http://www.archive.org/images/star.png,408), (http://www.archive.org/images/no_star.png,122), (http://www.archive.org/images/logo.jpg,118), (http://www.archive.org/images/main-header.jpg,84), (http://www.archive.org/images/rss.png,20), (http://www.archive.org/images/mail.gif,13), (http://www.archive.org/images/half_star.png,10), (http://www.archive.org/images/arrow.gif,7), (http://ia300142.us.archive.org/3/items/americana/am_libraries.gif?cnt=0,3), (http://ia310121.us.archive.org/2/items/GratefulDead/gratefuldead.gif?cnt=0,3), (http://www.archive.org/images/wayback.gif,2), (http://www.archive.org/images/wayback-election2000.gif,2), (http://www.archive.org/images/wayback-wt...
</code></pre>
<p>If you wanted to work with the images, you could download them from the
Internet Archive.</p>
<p>Let's use the top-ranked example. <a href="http://web.archive.org/web/*/http://archive.org/images/star.png">This
link</a>, for
example, will show you the temporal distribution of the image. For a snapshot
from September 2007, this URL would work:</p>
<p><a href="http://web.archive.org/web/20070913051458/http://www.archive.org/images/star.png">http://web.archive.org/web/20070913051458/http://www.archive.org/images/star.png</a></p>
<p>To do analysis on all images, you could thus prepend
<code>http://web.archive.org/web/20070913051458/</code> to each URL and <code>wget</code> them en
masse.</p>
<p>For more information on <code>wget</code>, please consult <a href="http://programminghistorian.org/lessons/automated-downloading-with-wget">this lesson available on the
Programming Historian
website</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="scala-df-2"></a><a href="#scala-df-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).imagegraph();

df.groupBy($<span class="hljs-string">"image_url"</span>)
  .count()
  .orderBy($<span class="hljs-string">"count"</span>.desc)
  .show(<span class="hljs-number">10</span>)
</code></pre>
<p>Will extract the top ten URLs of images found within a collection, in a
DataFrame like so:</p>
<pre><code class="hljs css language-dataframe">+--------------------+-----+
|<span class="hljs-string">           image_url</span>|<span class="hljs-string">count</span>|
+--------------------+-----+
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">  408</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">  122</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   83</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   49</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   20</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   13</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   10</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">    7</span>|
|<span class="hljs-string">http://ia300142.u...</span>|<span class="hljs-string">    3</span>|
|<span class="hljs-string">http://ia310121.u...</span>|<span class="hljs-string">    3</span>|
+--------------------+-----+
only showing top 10 rows

import io.archivesunleashed._
import io.archivesunleashed.udfs._
df: org.apache.spark.sql.DataFrame = [src: string, image_url: string]
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="python-df-2"></a><a href="#python-df-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *

archive = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>)

df = archive.imagegraph()

df.groupBy(<span class="hljs-string">"image_url"</span>)
  .count()
  .orderBy(<span class="hljs-string">"count"</span>, ascending=<span class="hljs-literal">False</span>)
  .show(<span class="hljs-number">10</span>)
</code></pre>
<p>Will extract the top ten URLs of images found within a collection, in a
DataFrame like so:</p>
<pre><code class="hljs css language-dataframe">+--------------------+-----+
|<span class="hljs-string">           image_url</span>|<span class="hljs-string">count</span>|
+--------------------+-----+
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">  408</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">  122</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   83</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   49</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   20</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   13</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">   10</span>|
|<span class="hljs-string">http://www.archiv...</span>|<span class="hljs-string">    7</span>|
|<span class="hljs-string">http://ia300142.u...</span>|<span class="hljs-string">    3</span>|
|<span class="hljs-string">http://ia310121.u...</span>|<span class="hljs-string">    3</span>|
+--------------------+-----+
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extract-most-frequent-images-md5-hash"></a><a href="#extract-most-frequent-images-md5-hash" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extract Most Frequent Images MD5 Hash</h2>
<p>Some images may be the same, but have different URLs. This UDF finds the
popular images by calculating the MD5 hash of each and presents the most
frequent images based on that metric. This script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.app._
<span class="hljs-keyword">import</span> io.archivesunleashed.matchbox._

<span class="hljs-keyword">val</span> r = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>,sc).persist()
<span class="hljs-type">ExtractPopularImages</span>(r, <span class="hljs-number">500</span>, sc).saveAsTextFile(<span class="hljs-string">"500-Popular-Images"</span>)
</code></pre>
<p>Will save the 500 most popular URLs to an output directory.</p>
<h3><a class="anchor" aria-hidden="true" id="scala-df-3"></a><a href="#scala-df-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.app._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>,sc).images()

<span class="hljs-type">ExtractPopularImagesDF</span>(df,<span class="hljs-number">10</span>,<span class="hljs-number">30</span>,<span class="hljs-number">30</span>).show()
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="python-df-3"></a><a href="#python-df-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python DF</h3>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *

images = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>).images()

popular_images = ExtractPopularImages(images, <span class="hljs-number">20</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>)

popular_images.show()
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="find-images-shared-between-domains"></a><a href="#find-images-shared-between-domains" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Find Images Shared Between Domains</h2>
<p>How to find images shared between domains that appear more than once <em>in more
than one domain</em>.</p>
<h3><a class="anchor" aria-hidden="true" id="scala-df-4"></a><a href="#scala-df-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> images = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc)
                        .images()
                        .select(removePrefixWWW(extractDomain($<span class="hljs-string">"url"</span>)).as(<span class="hljs-string">"domain"</span>), $<span class="hljs-string">"url"</span>, $<span class="hljs-string">"md5"</span>)

<span class="hljs-keyword">val</span> links = images.groupBy(<span class="hljs-string">"md5"</span>).count().where(countDistinct(<span class="hljs-string">"domain"</span>)&gt;=<span class="hljs-number">2</span>)

<span class="hljs-keyword">val</span> result = images.join(links, <span class="hljs-string">"md5"</span>)
                   .groupBy(<span class="hljs-string">"domain"</span>, <span class="hljs-string">"md5"</span>)
                   .agg(first(<span class="hljs-string">"url"</span>).as(<span class="hljs-string">"image_url"</span>))
                   .orderBy(asc(<span class="hljs-string">"md5"</span>))
                   .write.csv(<span class="hljs-string">"/path/to/output"</span>)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="pythondf"></a><a href="#pythondf" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>PythonDF</h3>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *
<span class="hljs-keyword">from</span> pyspark.sql.functions <span class="hljs-keyword">import</span> asc, countDistinct, first

images = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>) \
  .images() \
  .select(remove_prefix_www(extract_domain(<span class="hljs-string">"url"</span>)).alias(<span class="hljs-string">"domain"</span>), <span class="hljs-string">"url"</span>, <span class="hljs-string">"md5"</span>)

links = images.groupBy(<span class="hljs-string">"md5"</span>) \
              .count() \
              .where(countDistinct(<span class="hljs-string">"domain"</span>)&gt;=<span class="hljs-number">2</span>)

result = images.join(links, <span class="hljs-string">"md5"</span>) \
               .groupBy(<span class="hljs-string">"domain"</span>, <span class="hljs-string">"md5"</span>) \
               .agg(first(<span class="hljs-string">"url"</span>).alias(<span class="hljs-string">"image_url"</span>)) \
               .orderBy(asc(<span class="hljs-string">"md5"</span>)) \
               .write.csv(<span class="hljs-string">"/path/to/output"</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extract-pdf-information"></a><a href="#extract-pdf-information" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extract PDF Information</h2>
<h3><a class="anchor" aria-hidden="true" id="scala-rdd-3"></a><a href="#scala-rdd-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala RDD</h3>
<p><strong>Will not be implemented.</strong></p>
<h3><a class="anchor" aria-hidden="true" id="scala-df-5"></a><a href="#scala-df-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).pdfs();

df.select($<span class="hljs-string">"url"</span>, $<span class="hljs-string">"filename"</span>, $<span class="hljs-string">"extension"</span>, $<span class="hljs-string">"mime_type_web_server"</span>, $<span class="hljs-string">"mime_type_tika"</span>, $<span class="hljs-string">"md5"</span>, $<span class="hljs-string">"sha1"</span>, $<span class="hljs-string">"bytes"</span>)
  .orderBy(desc(<span class="hljs-string">"md5"</span>))
  .show()
</code></pre>
<p>Will extract all following information from PDF files in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string"> mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">adicec_sopar_2009...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">ffc2ccc373b8ffd39...</span>|<span class="hljs-string">3831b0f228af1701e...</span>|<span class="hljs-string">JVBERi0xLjMNJeLjz...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">      IntSt_2301.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">ffa638c418dac2e19...</span>|<span class="hljs-string">84dbaccde1ace4b24...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">            lotg.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">ff871ef64d3739b03...</span>|<span class="hljs-string">95a777f0b4c7703c6...</span>|<span class="hljs-string">JVBERi0xLjINJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            ebad.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fe8feece5d08dc2ce...</span>|<span class="hljs-string">0c01cc31b40a286da...</span>|<span class="hljs-string">JVBERi0xLjMNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      regulament.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fe8018451633fd76c...</span>|<span class="hljs-string">9c7cc720e29cad6e8...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">dmatias_letterfor...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fe7dbc89e664ba790...</span>|<span class="hljs-string">dbe965e7a288cce59...</span>|<span class="hljs-string">JVBERi0xLjYNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">overcome_the_fear...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fe3ec0805564cd3fc...</span>|<span class="hljs-string">d0d30ba4f7f40434d...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       CIM_marks.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fe1622ac08b47cf60...</span>|<span class="hljs-string">b97b57b3c77887324...</span>|<span class="hljs-string">JVBERi0xLjMKJcTl8...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           board.PDF</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fd969b57508d3b135...</span>|<span class="hljs-string">fc121c07fefbb722b...</span>|<span class="hljs-string">JVBERi0xLjIgDQol4...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          cowell.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fbacc01cbe01aa0b4...</span>|<span class="hljs-string">f9e9eba1b281ad800...</span>|<span class="hljs-string">JVBERi0xLjMKJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        gdbrasil.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fadc9b9b2408a1112...</span>|<span class="hljs-string">247671acb971ddc21...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">         EBOrder.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fa4a83d96441324b3...</span>|<span class="hljs-string">5f6870832d035a5a9...</span>|<span class="hljs-string">JVBERi0xLjINJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        butlleta.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fa13dfbf62acb5083...</span>|<span class="hljs-string">9a8ec0c0e8a190f46...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">ALABAMAUNDERWOODM...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">f9791c7df35d9092a...</span>|<span class="hljs-string">3e4c0ca1031152d24...</span>|<span class="hljs-string">JVBERi0xLjIgDQol4...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         chimera.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">f92a40f58cffcdc8e...</span>|<span class="hljs-string">ba038d0146b0171f2...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          icarus.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">f8da963b714e684b3...</span>|<span class="hljs-string">4444f5a12c9dbb1df...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">2008_ClubFinances...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">f878c0373edbc89f9...</span>|<span class="hljs-string">700393c7b6aaf93df...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">  WILLOWSTScene5.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">f84fc521602fdf163...</span>|<span class="hljs-string">5f03b19201536cbc8...</span>|<span class="hljs-string">JVBERi0xLjQKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        isrherb2.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">f83390642e9fe6313...</span>|<span class="hljs-string">60befa2b5913bb19d...</span>|<span class="hljs-string">JVBERi0xLjMNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            joel.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">f828e4b447c085fdd...</span>|<span class="hljs-string">2e3308c1a52f2f75a...</span>|<span class="hljs-string">JVBERi0xLjQKJcOkw...</span>|
+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
only showing top 20 rows

import io.archivesunleashed._
import io.archivesunleashed.udfs._
df: org.apache.spark.sql.DataFrame = [url: string, filename: string ... 6 more fields]
</code></pre>
<p>If you wanted to work with all the PDF files in a collection, you could extract
them with the following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).pdfs();

df.select($<span class="hljs-string">"bytes"</span>, $<span class="hljs-string">"extension"</span>)
  .saveToDisk(<span class="hljs-string">"bytes"</span>, <span class="hljs-string">"/path/to/export/directory/your-preferred-filename-prefix"</span>, $<span class="hljs-string">"extension"</span>)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="python-df-4"></a><a href="#python-df-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *

archive = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>)

df = archive.pdfs()
df.show()
</code></pre>
<p>Will extract all following information from PDF files in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string"> mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">20080304ordinance...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">ebbf9bf99b363493b...</span>|<span class="hljs-string">f0b9a6788cbc1f8ab...</span>|<span class="hljs-string">JVBERi0xLjMNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">FACTSHEET2008ADOP...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">4fe261c2210189a52...</span>|<span class="hljs-string">a91180b9170ff757f...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            Menu.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">75e4d587589a1d85d...</span>|<span class="hljs-string">d18724100d4616a45...</span>|<span class="hljs-string">JVBERi0xLjMNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">DSTC2009ContestFl...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">c80f38f96480aab0c...</span>|<span class="hljs-string">369c4415ed9c2476d...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            ebad.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fe8feece5d08dc2ce...</span>|<span class="hljs-string">0c01cc31b40a286da...</span>|<span class="hljs-string">JVBERi0xLjMNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">FACTSHEET2008APPR...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">8747971e78acb768b...</span>|<span class="hljs-string">770f97a95c7e2ee16...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">FACTSHEET2008APPE...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">32f57bbe5b28f4ab1...</span>|<span class="hljs-string">d4f63b8d29f4c5dc5...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">FACTSHEET2008ADOP...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">e9189eea563fde074...</span>|<span class="hljs-string">f14b1846499dd4bd0...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          sharar.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">771f5bd1b72b8e324...</span>|<span class="hljs-string">9cef1f6af9e5c127e...</span>|<span class="hljs-string">JVBERi0xLjMNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">FACTSHEET2008UTIL...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">7f45c93d16823e852...</span>|<span class="hljs-string">b3a2d3b95efd77bd6...</span>|<span class="hljs-string">JVBERi0xLjQNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">BakweriMarginalis...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">d25863303ba46a872...</span>|<span class="hljs-string">bbd6c9bce4c523f0f...</span>|<span class="hljs-string">JVBERi0xLjINJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">McCallaFoodSecuri...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">1291b633f49f7e51d...</span>|<span class="hljs-string">622144ed0fd56bae3...</span>|<span class="hljs-string">JVBERi0xLjMNJeLjz...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">PovertyAndIncome.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">278e1f281905d419d...</span>|<span class="hljs-string">9bc00a54147a4b350...</span>|<span class="hljs-string">JVBERi0xLjIgDSXi4...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          behold.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">9fc1e4e1e0f567477...</span>|<span class="hljs-string">63d324984d34eb168...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">overcome_the_fear...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">fe3ec0805564cd3fc...</span>|<span class="hljs-string">d0d30ba4f7f40434d...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           raven.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">acabc7f7dba954f99...</span>|<span class="hljs-string">1ddf3e53813a805a1...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          sunset.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">1dc037712d47b11d9...</span>|<span class="hljs-string">f502ca5cc2de2483b...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">night_lasts_less_...</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">1cda3dfab3bedaf04...</span>|<span class="hljs-string">ad0f6e6fd53e4eb5f...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      angel_dust.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">92d14676e34dfcb7e...</span>|<span class="hljs-string">1588b870928d56667...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         vampire.pdf</span>|<span class="hljs-string">      pdf</span>|<span class="hljs-string">application/octet...</span>|<span class="hljs-string">application/pdf</span>|<span class="hljs-string">f1730689d52b9524e...</span>|<span class="hljs-string">bf377a4e2580b8a29...</span>|<span class="hljs-string">JVBERi0xLjMKJcfsj...</span>|
+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
only showing top 20 rows
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extract-presentation-program-files-information"></a><a href="#extract-presentation-program-files-information" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extract Presentation Program Files Information</h2>
<h3><a class="anchor" aria-hidden="true" id="scala-rdd-4"></a><a href="#scala-rdd-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala RDD</h3>
<p><strong>Will not be implemented.</strong></p>
<h3><a class="anchor" aria-hidden="true" id="scala-df-6"></a><a href="#scala-df-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).presentationProgramFiles();

df.select($<span class="hljs-string">"url"</span>, $<span class="hljs-string">"filename"</span>, $<span class="hljs-string">"extension"</span>, $<span class="hljs-string">"mime_type_web_server"</span>, $<span class="hljs-string">"mime_type_tika"</span>, $<span class="hljs-string">"md5"</span>, $<span class="hljs-string">"sha1"</span>, $<span class="hljs-string">"bytes"</span>)
  .orderBy(desc(<span class="hljs-string">"md5"</span>))
  .show()
</code></pre>
<p>Will extract all following information from presentation program files in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">      mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           index.pps</span>|<span class="hljs-string">      pps</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">fbaed5a1df163270a...</span>|<span class="hljs-string">afa4c82593ea5bfd6...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">MathForEveryoneCa...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">f5fde5813a5aef2f3...</span>|<span class="hljs-string">e791212ac91243f39...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">AD1-GE-Quiz4-Samp...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">f5824d64bb74b1377...</span>|<span class="hljs-string">aaea2a38d11682753...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">    Agrarianism1.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">f581932d9e4c57dc0...</span>|<span class="hljs-string">3fbce2d175be293a8...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            lego.pps</span>|<span class="hljs-string">      pps</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">f0da5c58e7abbf102...</span>|<span class="hljs-string">78bc45da68c6784be...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            HPIB.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">ef09c31bd8079d40b...</span>|<span class="hljs-string">875a96d8b8dd3bf18...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">learningdisabilit...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">e6bb4f98761839a3a...</span>|<span class="hljs-string">5a4dcc8bab2ee15f3...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">assessmentsummer.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">e116a443b9031ec01...</span>|<span class="hljs-string">141563f2f32687587...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">CommonlyConfusedW...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">dde43870e0da8ebf6...</span>|<span class="hljs-string">7a94bf766d931a046...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">AD1-Unit5-Achieve...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">d4530e506c2e41f8f...</span>|<span class="hljs-string">6c89c0e3d28ecceed...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">         Schwind.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">cfdd4bb6e7b04f24a...</span>|<span class="hljs-string">9c26a8ac091f88a35...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">  cpphtp4_PPT_07.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">cd98e6e18c3b0ada0...</span>|<span class="hljs-string">b3651507f61bafa4d...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          mylife.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">cb146894f8a544ace...</span>|<span class="hljs-string">0129cfdfd2f196346...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    refinterview.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">ca6fd4ec5fcb8237d...</span>|<span class="hljs-string">8312ca4c0dbeb6008...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">MathForEveryoneAl...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c887f45fa58f273b0...</span>|<span class="hljs-string">b253b732f8502f357...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">   ch2-DataTypes.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c74caee72b5ee6684...</span>|<span class="hljs-string">f3bf878c775e2f72a...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">geographyofnortha...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c35b93ac59f2eb5af...</span>|<span class="hljs-string">b5de05a856838328c...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       people1st.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">bf19cdc1ff3ad82fd...</span>|<span class="hljs-string">99f14fe81d8a9587f...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     AD1-Reading.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">be020b4564f972218...</span>|<span class="hljs-string">0761a2fd5c176ce1c...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         majalah.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">b6f219693ef1df49f...</span>|<span class="hljs-string">1039013624cf8de35...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
only showing top 20 rows

import io.archivesunleashed._
import io.archivesunleashed.udfs._
df: org.apache.spark.sql.DataFrame = [url: string, filename: string ... 6 more fields]
</code></pre>
<p>If you wanted to work with all the presentation program files in a collection,
you could extract them with the following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).presentationProgramFiles();

df.select($<span class="hljs-string">"bytes"</span>, $<span class="hljs-string">"extension"</span>)
  .saveToDisk(<span class="hljs-string">"bytes"</span>, <span class="hljs-string">"/path/to/export/directory/your-preferred-filename-prefix"</span>, $<span class="hljs-string">"extension"</span>)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="python-df-5"></a><a href="#python-df-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *

archive = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>)

df = archive.presentation_program()
df.show()
</code></pre>
<p>Will extract all following information from presentation program files in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">      mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          wincvs.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">52ac23b58493234b2...</span>|<span class="hljs-string">a2206af9847cceb06...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           index.pps</span>|<span class="hljs-string">      pps</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">fbaed5a1df163270a...</span>|<span class="hljs-string">afa4c82593ea5bfd6...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">MathForEveryoneCa...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">f5fde5813a5aef2f3...</span>|<span class="hljs-string">e791212ac91243f39...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">MathForEveryone7t...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">9893643e1cb87af0c...</span>|<span class="hljs-string">2fa8301893ad21b2b...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">MathForEveryoneGe...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">2a914a95a61b227dd...</span>|<span class="hljs-string">5d783c1beaffc0b57...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">MathForEveryoneAl...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c887f45fa58f273b0...</span>|<span class="hljs-string">b253b732f8502f357...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">MathForEveryone7t...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">034906471a0c0b997...</span>|<span class="hljs-string">16142a0aa69b2fb1f...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">           tiago.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">6871786192c187783...</span>|<span class="hljs-string">e5a91a65ef9a4bade...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        energypp.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">94f9384ec57d8849c...</span>|<span class="hljs-string">e943c5cf509f8f816...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            lego.pps</span>|<span class="hljs-string">      pps</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">f0da5c58e7abbf102...</span>|<span class="hljs-string">78bc45da68c6784be...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      celtiberos.pps</span>|<span class="hljs-string">      pps</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">af897525acd31d359...</span>|<span class="hljs-string">9c018a80253c38a57...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          porque.pps</span>|<span class="hljs-string">      pps</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">9c2cba37c64fd0ac8...</span>|<span class="hljs-string">6f11733ddec0abc2d...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">SoftHandoffbyPara...</span>|<span class="hljs-string">      pps</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">0c5ef732ea466574f...</span>|<span class="hljs-string">dc7dfe545b401aeab...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">A_Land_Remembered...</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">5b7273d03f8490490...</span>|<span class="hljs-string">2d8721e7876cb6697...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           DANCE.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">5aa3308433666a30a...</span>|<span class="hljs-string">4a23bd20768501dac...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            unit.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">6736886864069ee66...</span>|<span class="hljs-string">e92031e6e0293cb73...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         majalah.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">b6f219693ef1df49f...</span>|<span class="hljs-string">1039013624cf8de35...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">esos_si_son_probl...</span>|<span class="hljs-string">      pps</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">932221045b6154d7e...</span>|<span class="hljs-string">b23a0238c852d28bb...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    refinterview.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">ca6fd4ec5fcb8237d...</span>|<span class="hljs-string">8312ca4c0dbeb6008...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">         Schwind.ppt</span>|<span class="hljs-string">      ppt</span>|<span class="hljs-string">application/mspow...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">cfdd4bb6e7b04f24a...</span>|<span class="hljs-string">9c26a8ac091f88a35...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
only showing top 20 rows
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extract-spreadsheet-information"></a><a href="#extract-spreadsheet-information" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extract Spreadsheet Information</h2>
<h3><a class="anchor" aria-hidden="true" id="scala-rdd-5"></a><a href="#scala-rdd-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala RDD</h3>
<p><strong>Will not be implemented.</strong></p>
<h3><a class="anchor" aria-hidden="true" id="scala-df-7"></a><a href="#scala-df-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).spreadsheets();

df.select($<span class="hljs-string">"url"</span>, $<span class="hljs-string">"filename"</span>, $<span class="hljs-string">"extension"</span>, $<span class="hljs-string">"mime_type_web_server"</span>, $<span class="hljs-string">"mime_type_tika"</span>, $<span class="hljs-string">"md5"</span>, $<span class="hljs-string">"sha1"</span>, $<span class="hljs-string">"bytes"</span>)
  .orderBy(desc(<span class="hljs-string">"md5"</span>))
  .show()
</code></pre>
<p>Will extract all following information from spreadsheet files in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">      mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     statuscarib.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">f9fd18b158df52ff2...</span>|<span class="hljs-string">0d606f25ac3c9abc4...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       timesheet.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">f9549db15de69bc21...</span>|<span class="hljs-string">e9c239d812705842f...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">statusccusspring0...</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">ef99704e5a734f386...</span>|<span class="hljs-string">f265fc5c581ad1762...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">  Laboratorio_05.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">eb0e39898ba513234...</span>|<span class="hljs-string">976f69da07122d285...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">110_Laboratorio_6...</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">e5b7fee6d4c45e171...</span>|<span class="hljs-string">befd9670be70a4fdb...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          Pakuan.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">e386f85a7bd74b1ab...</span>|<span class="hljs-string">5b2b142de2c57ec68...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">Spring08_statusre...</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">df2d6792fb55c4e26...</span>|<span class="hljs-string">6f4d2aef711aff4e1...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    CTtimetable2.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">dc987d3e996677ce9...</span>|<span class="hljs-string">40bb63a4c0038a6ae...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">MalibuTrailChalle...</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">dbba76ead82576178...</span>|<span class="hljs-string">ffbe099441053b47b...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     CTtimetable.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">d9ee9117e70df43b5...</span>|<span class="hljs-string">596c4c6d5cdc7ddb5...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">  1071_Parcial_2.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">d90dc210138676a2c...</span>|<span class="hljs-string">6e3ed07f50393815c...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">excelsubtractione...</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">d6c8314e52f22e4aa...</span>|<span class="hljs-string">1b1ebce0f85628921...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">Fall2008_statusre...</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">cd9974430477b75ce...</span>|<span class="hljs-string">0e756bbc38608cb51...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        report01.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">cd947fe4099df4fe3...</span>|<span class="hljs-string">0f11d17d38a72977b...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">TrackRecords20010...</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c8aa0122443efa0e5...</span>|<span class="hljs-string">fa9cdb4a329f926bf...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://br.geociti...</span>|<span class="hljs-string">  mycoinsforswap.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c665c83bc2b54292f...</span>|<span class="hljs-string">18f1f3a4559d5c40a...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     AAtimetable.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c66201762bf5e473e...</span>|<span class="hljs-string">4e9bac4f217b0605d...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">   carwashroster.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c495d1b7dc954b975...</span>|<span class="hljs-string">062167485baf9aa5d...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         RSL_MDP.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">bf6479bacbb758b52...</span>|<span class="hljs-string">4d7ea33849447853d...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">  status_report4.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">bc4d18e022522d185...</span>|<span class="hljs-string">fc7b9fc64116c9ad1...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
only showing top 20 rows

import io.archivesunleashed._
import io.archivesunleashed.udfs._
df: org.apache.spark.sql.DataFrame = [url: string, filename: string ... 6 more fields]
</code></pre>
<p>If you wanted to work with all the spreadsheet files in a collection, you could extract
them with the following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).spreadsheets();

df.select($<span class="hljs-string">"bytes"</span>, $<span class="hljs-string">"extension"</span>)
  .saveToDisk(<span class="hljs-string">"bytes"</span>, <span class="hljs-string">"/path/to/export/directory/your-preferred-filename-prefix"</span>, $<span class="hljs-string">"extension"</span>)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="python-df-6"></a><a href="#python-df-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *

archive = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>)

df = archive.spreadsheets()
df.show()
</code></pre>
<p>Will extract all following information from spreadsheet files in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">      mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        tkadrosu.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">8033532f88da42ad6...</span>|<span class="hljs-string">a52b24bc760c5265b...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     cal_counter.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">56ad6c2f84fdd4a88...</span>|<span class="hljs-string">ad0db35f2d7ff2cca...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    CTtimetable2.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">dc987d3e996677ce9...</span>|<span class="hljs-string">40bb63a4c0038a6ae...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     AAtimetable.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c66201762bf5e473e...</span>|<span class="hljs-string">4e9bac4f217b0605d...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     CTtimetable.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">d9ee9117e70df43b5...</span>|<span class="hljs-string">596c4c6d5cdc7ddb5...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    CTtimetable2.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">a4ed4330d5c18f1b2...</span>|<span class="hljs-string">d8ce479596d49679d...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           teams.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">334fa42776cef7f81...</span>|<span class="hljs-string">aa57fda7fb634c931...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      collection.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">30d7a67de8150f712...</span>|<span class="hljs-string">841ba91f009d48b7a...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">music-collection.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">4def75fa96bae579d...</span>|<span class="hljs-string">090a95923c9599454...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          020103.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">48651a7592ca1b0f0...</span>|<span class="hljs-string">1e2438c8247d33870...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          011803.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">0aab8ed40f91c1c76...</span>|<span class="hljs-string">8e02e408fe1ce40b9...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     RSL_TorOton.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">1d9c13c6407a2b696...</span>|<span class="hljs-string">007010ecf5b208453...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         members.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">b045a6b118981c6eb...</span>|<span class="hljs-string">3ae096d6602b7cb36...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">        round309.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">50bed4b3e9facb278...</span>|<span class="hljs-string">f26e0c38082141598...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">       result109.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">2235d094897f10c3b...</span>|<span class="hljs-string">6ed0b65fd43502a2b...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">TrackRecords20010...</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">c8aa0122443efa0e5...</span>|<span class="hljs-string">fa9cdb4a329f926bf...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           Digox.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">182d08821797269c7...</span>|<span class="hljs-string">80e7ce8ecc1ecf389...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       RSL_SemBA.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">59613700fbf08b795...</span>|<span class="hljs-string">44eac99a514141520...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         RSL_MDP.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">bf6479bacbb758b52...</span>|<span class="hljs-string">4d7ea33849447853d...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       RSL_ARG99.xls</span>|<span class="hljs-string">      xls</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">application/vnd.m...</span>|<span class="hljs-string">a2f2fd063dd5689a7...</span>|<span class="hljs-string">61568e0f4139ec568...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
+--------------------+--------------------+---------+--------------------+--------------------+--------------------+--------------------+--------------------+
only showing top 20 rows
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extract-video-information"></a><a href="#extract-video-information" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extract Video Information</h2>
<h3><a class="anchor" aria-hidden="true" id="scala-rdd-6"></a><a href="#scala-rdd-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala RDD</h3>
<p><strong>Will not be implemented.</strong></p>
<h3><a class="anchor" aria-hidden="true" id="scala-df-8"></a><a href="#scala-df-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).videos();

df.select($<span class="hljs-string">"url"</span>, $<span class="hljs-string">"filename"</span>, $<span class="hljs-string">"extension"</span>, $<span class="hljs-string">"mime_type_web_server"</span>, $<span class="hljs-string">"mime_type_tika"</span>, $<span class="hljs-string">"md5"</span>, $<span class="hljs-string">"sha1"</span>, $<span class="hljs-string">"bytes"</span>)
  .orderBy(desc(<span class="hljs-string">"md5"</span>))
  .show()
</code></pre>
<p>Will extract all following information from videos in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string"> mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       videohead.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">fa9852748ba7b4829...</span>|<span class="hljs-string">0be56f200f8e1cb83...</span>|<span class="hljs-string">UklGRjoMIQBBVkkgT...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">       HandWrap2.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">f680cb463e7cb291e...</span>|<span class="hljs-string">1d2ea1df3f5af2599...</span>|<span class="hljs-string">UklGRrBrAgBBVkkgT...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         1kungfu.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">f4429277ed4b48efb...</span>|<span class="hljs-string">5c542e8990efd484b...</span>|<span class="hljs-string">UklGRkoSFwBBVkkgT...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">  Vol_III_sample.mpg</span>|<span class="hljs-string">      mpg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">f2bc34f7294edc376...</span>|<span class="hljs-string">a939dc619c123f81b...</span>|<span class="hljs-string">AAABuiEAAdLxgA7xA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         wherego.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">f23976ddeb6f08810...</span>|<span class="hljs-string">714a9a548f9b2a156...</span>|<span class="hljs-string">UklGRkq4HgBBVkkgT...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       couch100k.wmv</span>|<span class="hljs-string">      asf</span>|<span class="hljs-string">      video/x-ms-wmv</span>|<span class="hljs-string"> video/x-ms-asf</span>|<span class="hljs-string">ee316d5871acb7859...</span>|<span class="hljs-string">0593ebb8e450a6c3e...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    Mitwa_Lagaan.mp3</span>|<span class="hljs-string">       qt</span>|<span class="hljs-string">          audio/mpeg</span>|<span class="hljs-string">video/quicktime</span>|<span class="hljs-string">ebc5db8d30edd0135...</span>|<span class="hljs-string">d3ebdd6da2c732481...</span>|<span class="hljs-string">AAAE6W1vb3YAAABsb...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">       tydunking.mpg</span>|<span class="hljs-string">      mpg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">eaa0d14dc05bdab98...</span>|<span class="hljs-string">05d4ff2301d2d3818...</span>|<span class="hljs-string">AAABuiEAAQALgBcdA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       bigjleroy.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">e93538f0d76b86cca...</span>|<span class="hljs-string">ebeb89fc2fa8f7cd6...</span>|<span class="hljs-string">UklGRrjUCgBBVkkgT...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     NollieBs180.mov</span>|<span class="hljs-string">      mov</span>|<span class="hljs-string">     video/quicktime</span>|<span class="hljs-string">video/quicktime</span>|<span class="hljs-string">e7b97c287329340d5...</span>|<span class="hljs-string">138fb8b0dea4c8e16...</span>|<span class="hljs-string">AAAGwm1vb3YAAABsb...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">           shirt.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">e36119d3c78225cbf...</span>|<span class="hljs-string">11af72475ca754639...</span>|<span class="hljs-string">UklGRvhdHQBBVkkgT...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          atdawn.wma</span>|<span class="hljs-string">      asf</span>|<span class="hljs-string">      audio/x-ms-wma</span>|<span class="hljs-string"> video/x-ms-asf</span>|<span class="hljs-string">e1a85a79ea3ba5d96...</span>|<span class="hljs-string">1be05aecdff99298c...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">non_will_go_to_wa...</span>|<span class="hljs-string">      mov</span>|<span class="hljs-string">     video/quicktime</span>|<span class="hljs-string">video/quicktime</span>|<span class="hljs-string">de6cc975363c4076b...</span>|<span class="hljs-string">0c00d0be9c89f9e97...</span>|<span class="hljs-string">AAs4JW1kYXQAAA70A...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      Movies_20.mpeg</span>|<span class="hljs-string">     mpeg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">dd9d2af0c1318b5ff...</span>|<span class="hljs-string">9d06f09744fe93408...</span>|<span class="hljs-string">AAABuiEAV+PlgAU7A...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">        artilery.mpg</span>|<span class="hljs-string">      mpg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">dcecbdfe46448bffb...</span>|<span class="hljs-string">0b292aab1078d9bfa...</span>|<span class="hljs-string">AAABswsAkBP//+CkA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string"> tancfigurakbbpl.wmv</span>|<span class="hljs-string">      wmv</span>|<span class="hljs-string">      video/x-ms-wmv</span>|<span class="hljs-string"> video/x-ms-wmv</span>|<span class="hljs-string">dca4991392572dbc0...</span>|<span class="hljs-string">cb349bdc35484d976...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">          Trevi2.mov</span>|<span class="hljs-string">      mov</span>|<span class="hljs-string">     video/quicktime</span>|<span class="hljs-string">video/quicktime</span>|<span class="hljs-string">dc882205f5cae38f5...</span>|<span class="hljs-string">c9dd804e1ee140221...</span>|<span class="hljs-string">AAAEvG1vb3YAAAS0Y...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">skillful_driving_...</span>|<span class="hljs-string">      mpg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">db8a767b00884e426...</span>|<span class="hljs-string">f5a70cf5f091b530f...</span>|<span class="hljs-string">AAABuiEAAQABgAORA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      jeremy100k.wmv</span>|<span class="hljs-string">      asf</span>|<span class="hljs-string">      video/x-ms-wmv</span>|<span class="hljs-string"> video/x-ms-asf</span>|<span class="hljs-string">dafba744438ae0110...</span>|<span class="hljs-string">d3a217ce25507ae90...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">           mbrl2.mpg</span>|<span class="hljs-string">      mpg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">d8eb5a12f0da99ca0...</span>|<span class="hljs-string">8686002a444cc9dce...</span>|<span class="hljs-string">AAABswsAkBP//+CkA...</span>|
+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
only showing top 20 rows

import io.archivesunleashed._
import io.archivesunleashed.udfs._
df: org.apache.spark.sql.DataFrame = [url: string, filename: string ... 6 more fields]
</code></pre>
<p>If you wanted to work with all the video files in a collection, you could extract
them with the following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).videos();

df.select($<span class="hljs-string">"bytes"</span>, $<span class="hljs-string">"extension"</span>)
  .saveToDisk(<span class="hljs-string">"bytes"</span>, <span class="hljs-string">"/path/to/export/directory/your-preferred-filename-prefix"</span>, $<span class="hljs-string">"extension"</span>)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="python-df-7"></a><a href="#python-df-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *

archive = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>)

df = archive.video()
df.show()
</code></pre>
<p>Will extract all following information from videos in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string"> mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">Sea_Dawgs_2008_Ha...</span>|<span class="hljs-string">      wmv</span>|<span class="hljs-string">      video/x-ms-wmv</span>|<span class="hljs-string"> video/x-ms-wmv</span>|<span class="hljs-string">7b35e4cf60a3cfa67...</span>|<span class="hljs-string">b35ad7242e8135326...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">       Excedrine.wmv</span>|<span class="hljs-string">      wmv</span>|<span class="hljs-string">      video/x-ms-wmv</span>|<span class="hljs-string"> video/x-ms-wmv</span>|<span class="hljs-string">0aaf1d81ab6f2b354...</span>|<span class="hljs-string">0b52af5f5facfd30f...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        homework.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">4e06cbd11764cd2ac...</span>|<span class="hljs-string">770a8849375965b20...</span>|<span class="hljs-string">UklGRsrLAgBBVkkgT...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    macarenababy.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">600084bbd732c0fda...</span>|<span class="hljs-string">f99b2e31374d4ea18...</span>|<span class="hljs-string">UklGRrC0AwBBVkkgT...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">orlando_viggokiss...</span>|<span class="hljs-string">      wmv</span>|<span class="hljs-string">      video/x-ms-asf</span>|<span class="hljs-string"> video/x-ms-wmv</span>|<span class="hljs-string">79d093eb6184dba74...</span>|<span class="hljs-string">395eaf6dcb29a66d2...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">skillful_driving_...</span>|<span class="hljs-string">      mpg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">db8a767b00884e426...</span>|<span class="hljs-string">f5a70cf5f091b530f...</span>|<span class="hljs-string">AAABuiEAAQABgAORA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">gray_havens_2.35.MPG</span>|<span class="hljs-string">      mpg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">af71353d69af0b42f...</span>|<span class="hljs-string">f3625b897339b0f23...</span>|<span class="hljs-string">AAABuiEAAQABgAORA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         movie2.mpeg</span>|<span class="hljs-string">     mpeg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">3f6c7c48d2a990cf2...</span>|<span class="hljs-string">760e6752bfd9e8a84...</span>|<span class="hljs-string">AAABsxQA8MMCcSClE...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">       Sequence1.mov</span>|<span class="hljs-string">      mov</span>|<span class="hljs-string">     video/quicktime</span>|<span class="hljs-string">video/quicktime</span>|<span class="hljs-string">931fc4dee8aa260f9...</span>|<span class="hljs-string">5a5cf58e2a50cf942...</span>|<span class="hljs-string">AAELrG1vb3YAAABsb...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">           santa.mov</span>|<span class="hljs-string">      mov</span>|<span class="hljs-string">     video/quicktime</span>|<span class="hljs-string">video/quicktime</span>|<span class="hljs-string">8b9b98d0c567c4381...</span>|<span class="hljs-string">49f49dd23c3bad61b...</span>|<span class="hljs-string">AAAAIGZ0eXBxdCAgI...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          0602-2.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">92d04dbe7f1bdc109...</span>|<span class="hljs-string">65ed7327aece11bac...</span>|<span class="hljs-string">UklGRkauOABBVkkgT...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">           movie.mpg</span>|<span class="hljs-string">      mpg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">a0e86539e5eb9bd35...</span>|<span class="hljs-string">82eb4680a9f65ed1b...</span>|<span class="hljs-string">AAABuiEAAdLxgASfA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     misshawaii.mpeg</span>|<span class="hljs-string">     mpeg</span>|<span class="hljs-string">          video/mpeg</span>|<span class="hljs-string">     video/mpeg</span>|<span class="hljs-string">45cbfc4d03547861b...</span>|<span class="hljs-string">44c93f871ea602112...</span>|<span class="hljs-string">AAABuiEAAQABgAORA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      Explosions.wmv</span>|<span class="hljs-string">      wmv</span>|<span class="hljs-string">      video/x-ms-wmv</span>|<span class="hljs-string"> video/x-ms-wmv</span>|<span class="hljs-string">22cb24bffbd7eabf9...</span>|<span class="hljs-string">a44d261ef5d7e7993...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       couch100k.wmv</span>|<span class="hljs-string">      asf</span>|<span class="hljs-string">      video/x-ms-wmv</span>|<span class="hljs-string"> video/x-ms-asf</span>|<span class="hljs-string">ee316d5871acb7859...</span>|<span class="hljs-string">0593ebb8e450a6c3e...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      jeremy100k.wmv</span>|<span class="hljs-string">      asf</span>|<span class="hljs-string">      video/x-ms-wmv</span>|<span class="hljs-string"> video/x-ms-asf</span>|<span class="hljs-string">dafba744438ae0110...</span>|<span class="hljs-string">d3a217ce25507ae90...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       jedi_wade.mov</span>|<span class="hljs-string">      mov</span>|<span class="hljs-string">     video/quicktime</span>|<span class="hljs-string">video/quicktime</span>|<span class="hljs-string">674688fd09bf18d29...</span>|<span class="hljs-string">cd21c3a5b9e2f18b6...</span>|<span class="hljs-string">AAAFB21vb3YAAAT/Y...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">ylagallinanonosga...</span>|<span class="hljs-string">      asf</span>|<span class="hljs-string">      audio/x-ms-wma</span>|<span class="hljs-string"> video/x-ms-asf</span>|<span class="hljs-string">9aac473134d7f2e7a...</span>|<span class="hljs-string">3af7fbab238772f48...</span>|<span class="hljs-string">MCaydY5mzxGm2QCqA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">Chris-5050NollieS...</span>|<span class="hljs-string">      mov</span>|<span class="hljs-string">     video/quicktime</span>|<span class="hljs-string">video/quicktime</span>|<span class="hljs-string">93aa2ce07e01f90ad...</span>|<span class="hljs-string">f066f29e5faf0cee1...</span>|<span class="hljs-string">AAAHRG1vb3YAAABsb...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string"> floursack_jump2.avi</span>|<span class="hljs-string">      avi</span>|<span class="hljs-string">     video/x-msvideo</span>|<span class="hljs-string">video/x-msvideo</span>|<span class="hljs-string">a922441c0a7f0018d...</span>|<span class="hljs-string">b82ca6fe1d46e16dc...</span>|<span class="hljs-string">UklGRgjlAwBBVkkgT...</span>|
+--------------------+--------------------+---------+--------------------+---------------+--------------------+--------------------+--------------------+
only showing top 20 rows
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="extract-word-processor-files-information"></a><a href="#extract-word-processor-files-information" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extract Word Processor Files Information</h2>
<h3><a class="anchor" aria-hidden="true" id="scala-rdd-7"></a><a href="#scala-rdd-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala RDD</h3>
<p><strong>Will not be implemented.</strong></p>
<h3><a class="anchor" aria-hidden="true" id="scala-df-9"></a><a href="#scala-df-9" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Scala DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).wordProcessorFiles();

df.select($<span class="hljs-string">"url"</span>, $<span class="hljs-string">"filename"</span>, $<span class="hljs-string">"extension"</span>, $<span class="hljs-string">"mime_type_web_server"</span>, $<span class="hljs-string">"mime_type_tika"</span>, $<span class="hljs-string">"md5"</span>, $<span class="hljs-string">"sha1"</span>, $<span class="hljs-string">"bytes"</span>)
  .orderBy(desc(<span class="hljs-string">"md5"</span>))
  .show()
</code></pre>
<p>Will extract all following information from word processor files in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">    mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">infiniteproducts.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">ffa1ea83af6cb9508...</span>|<span class="hljs-string">7a3ae86a7a22d2682...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      Everything.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">ff7216edf86fe196c...</span>|<span class="hljs-string">082a889c27640fc9a...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          survey.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">ff48df5e64bd5adeb...</span>|<span class="hljs-string">383ab6ead48795ff3...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string"> iepWrkshpFall01.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">ff421feb87b826d39...</span>|<span class="hljs-string">ec60a48d393642629...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">24_reproduction_s...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fec21eb30fac4588e...</span>|<span class="hljs-string">36b41ba66801b10b9...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">Descendit_ad_Infe...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fe66eeb7c04942c8b...</span>|<span class="hljs-string">14f207787abef983e...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">Anthropology21FEB...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fe079d498bd5e91f2...</span>|<span class="hljs-string">ca54e6be7c0618ecc...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">          Senses.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fdf881ef998c227f7...</span>|<span class="hljs-string">04d6e72132537053a...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">hopewel-loudon-cl...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fddffbabcaf1976c9...</span>|<span class="hljs-string">b7ade5d661dd597a1...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">   billmprev9899.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fdcc8b65cfb0a18c9...</span>|<span class="hljs-string">602f323278c9fb726...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">approachesProject...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fd4df7f89efe9cea7...</span>|<span class="hljs-string">4e7be7664bfe992f3...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         batayan.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fc6f45fdfce72d4a3...</span>|<span class="hljs-string">e614c9b9e95d64aa6...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string"> VisitUnitPacket.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fc2a0e45b627c3d4a...</span>|<span class="hljs-string">dc7ba874b7b13d548...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">vc3c3ppstudyguide...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fc293bbddb906615f...</span>|<span class="hljs-string">538aa0d5e2f554258...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">30_chordates_fish...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fc053770a82822f69...</span>|<span class="hljs-string">9df86863983889373...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">c6artposterexampl...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fbe2427b48f32d1d9...</span>|<span class="hljs-string">47de792202dc3a059...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">        kun20509.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fb8d1ae5e3db45131...</span>|<span class="hljs-string">6b13d73759a956e62...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">            kun20509</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fb8d1ae5e3db45131...</span>|<span class="hljs-string">6b13d73759a956e62...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">         Fishing.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fb7df7ac80aa2cc8a...</span>|<span class="hljs-string">eb4bb266226349bac...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">      resumedoAw.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">fb6d5bf501b9b97b3...</span>|<span class="hljs-string">1e0d6500192d4ee21...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
+--------------------+--------------------+---------+--------------------+------------------+--------------------+--------------------+--------------------+
only showing top 20 rows

import io.archivesunleashed._
import io.archivesunleashed.udfs._
df: org.apache.spark.sql.DataFrame = [url: string, filename: string ... 6 more fields]
</code></pre>
<p>If you wanted to work with all the word processor files in a collection,
you could extract them with the following script:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> io.archivesunleashed._
<span class="hljs-keyword">import</span> io.archivesunleashed.udfs._

<span class="hljs-keyword">val</span> df = <span class="hljs-type">RecordLoader</span>.loadArchives(<span class="hljs-string">"/path/to/warcs"</span>, sc).wordProcessorFiles();

df.select($<span class="hljs-string">"bytes"</span>, $<span class="hljs-string">"extension"</span>)
  .saveToDisk(<span class="hljs-string">"bytes"</span>, <span class="hljs-string">"/path/to/export/directory/your-preferred-filename-prefix"</span>, $<span class="hljs-string">"extension"</span>)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="python-df-8"></a><a href="#python-df-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Python DF</h3>
<p>The following script:</p>
<pre><code class="hljs css language-python"><span class="hljs-keyword">from</span> aut <span class="hljs-keyword">import</span> *

archive = WebArchive(sc, sqlContext, <span class="hljs-string">"/path/to/warcs"</span>)

df = archive.word_processor()
df.show()
</code></pre>
<p>Will extract all following information from word processor files in a web collection:</p>
<ul>
<li>file url</li>
<li>filename</li>
<li>extension</li>
<li>MimeType as identified by the hosting web server</li>
<li>MimeType as identified by <a href="https://tika.apache.org">Apache Tika</a></li>
<li>md5 hash</li>
<li>sha1 hash</li>
<li>bytes</li>
</ul>
<pre><code class="hljs css language-dataframe">+--------------------+--------------------+---------+--------------------+------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">                 url</span>|<span class="hljs-string">            filename</span>|<span class="hljs-string">extension</span>|<span class="hljs-string">mime_type_web_server</span>|<span class="hljs-string">    mime_type_tika</span>|<span class="hljs-string">                 md5</span>|<span class="hljs-string">                sha1</span>|<span class="hljs-string">               bytes</span>|
+--------------------+--------------------+---------+--------------------+------------------+--------------------+--------------------+--------------------+
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">            Doc2.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">09159efbefff59f64...</span>|<span class="hljs-string">5412d6c55c2c8bec7...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        CV-ITjob.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">7f2b7540e558de24e...</span>|<span class="hljs-string">96a6ece7202ab309b...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        CV-Teach.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">637bb22eff4bc5be5...</span>|<span class="hljs-string">76130b6ffeac5c678...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">       CV-covlet.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">466c06bfa5a47d5cb...</span>|<span class="hljs-string">dc763126cbdb589eb...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        CV-extra.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">ab0fa931229c02a4b...</span>|<span class="hljs-string">4c2a8200e6eaaafb2...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">020410Indonesia_N...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">b195e90841347be61...</span>|<span class="hljs-string">6d2845902ad15a9a2...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        Chapter1.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">65383c8c0cf5b6a4f...</span>|<span class="hljs-string">fcf3008e9478b773c...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">CathyKoning_resum...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">924ad3f9f66d3c6bd...</span>|<span class="hljs-string">2d0887c93ffd3e78b...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">  Greek_colonels.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">ee4b9db827086d0db...</span>|<span class="hljs-string">94e5569e064195db5...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">         resume2.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">c39fa601733093268...</span>|<span class="hljs-string">108563de6ba6102a5...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     eta_writeup.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">661328d76ce3aa340...</span>|<span class="hljs-string">debadb248da4dfbd3...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">Before_Night_Fall...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">a40371b35b4bf0838...</span>|<span class="hljs-string">8f1dba8a46ea297b8...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">Membership_Form_2...</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">bf3a3b8cc86b371c3...</span>|<span class="hljs-string">472810e93a2245fb1...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">  walkthroughff1.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">c97de6941c3fb4aed...</span>|<span class="hljs-string">16851a5445bdce07d...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">    Encyclopedia.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">26a94e8f3358c878c...</span>|<span class="hljs-string">07f9b2ce6342f73bc...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">        Y.Kurulu.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">8e0ebe7c4f27b1841...</span>|<span class="hljs-string">ebb5ce328f717f8e6...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://www.geocit...</span>|<span class="hljs-string">      fifty_eggs.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">2c1cdd4f75030650e...</span>|<span class="hljs-string">d022311b2fc399750...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     1pitagoras2.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">e07ff47cb8ebc4356...</span>|<span class="hljs-string">97d46d781458f5a82...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">    constitution.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">e38dc3e5d553d8799...</span>|<span class="hljs-string">d50096b5208146ce9...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
|<span class="hljs-string">http://geocities....</span>|<span class="hljs-string">     feasibility.doc</span>|<span class="hljs-string">      doc</span>|<span class="hljs-string">  application/msword</span>|<span class="hljs-string">application/msword</span>|<span class="hljs-string">5574bf82d65935191...</span>|<span class="hljs-string">53de74880c9ea2e2b...</span>|<span class="hljs-string">0M8R4KGxGuEAAAAAA...</span>|
+--------------------+--------------------+---------+--------------------+------------------+--------------------+--------------------+--------------------+
only showing top 20 rows
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/0.90.3/image-analysis"><span class="arrow-prev">← </span><span>Previous</span></a><a class="docs-next button" href="/docs/0.90.3/filters-rdd"><span>RDD Filters</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#extract-audio-information">Extract Audio Information</a><ul class="toc-headings"><li><a href="#scala-rdd">Scala RDD</a></li><li><a href="#scala-df">Scala DF</a></li><li><a href="#python-df">Python DF</a></li></ul></li><li><a href="#extract-image-information">Extract Image Information</a><ul class="toc-headings"><li><a href="#scala-rdd-1">Scala RDD</a></li><li><a href="#scala-df-1">Scala DF</a></li><li><a href="#python-df-1">Python DF</a></li></ul></li><li><a href="#extract-most-frequent-image-urls">Extract Most Frequent Image URLs</a><ul class="toc-headings"><li><a href="#scala-rdd-2">Scala RDD</a></li><li><a href="#scala-df-2">Scala DF</a></li><li><a href="#python-df-2">Python DF</a></li></ul></li><li><a href="#extract-most-frequent-images-md5-hash">Extract Most Frequent Images MD5 Hash</a><ul class="toc-headings"><li><a href="#scala-df-3">Scala DF</a></li><li><a href="#python-df-3">Python DF</a></li></ul></li><li><a href="#find-images-shared-between-domains">Find Images Shared Between Domains</a><ul class="toc-headings"><li><a href="#scala-df-4">Scala DF</a></li><li><a href="#pythondf">PythonDF</a></li></ul></li><li><a href="#extract-pdf-information">Extract PDF Information</a><ul class="toc-headings"><li><a href="#scala-rdd-3">Scala RDD</a></li><li><a href="#scala-df-5">Scala DF</a></li><li><a href="#python-df-4">Python DF</a></li></ul></li><li><a href="#extract-presentation-program-files-information">Extract Presentation Program Files Information</a><ul class="toc-headings"><li><a href="#scala-rdd-4">Scala RDD</a></li><li><a href="#scala-df-6">Scala DF</a></li><li><a href="#python-df-5">Python DF</a></li></ul></li><li><a href="#extract-spreadsheet-information">Extract Spreadsheet Information</a><ul class="toc-headings"><li><a href="#scala-rdd-5">Scala RDD</a></li><li><a href="#scala-df-7">Scala DF</a></li><li><a href="#python-df-6">Python DF</a></li></ul></li><li><a href="#extract-video-information">Extract Video Information</a><ul class="toc-headings"><li><a href="#scala-rdd-6">Scala RDD</a></li><li><a href="#scala-df-8">Scala DF</a></li><li><a href="#python-df-7">Python DF</a></li></ul></li><li><a href="#extract-word-processor-files-information">Extract Word Processor Files Information</a><ul class="toc-headings"><li><a href="#scala-rdd-7">Scala RDD</a></li><li><a href="#scala-df-9">Scala DF</a></li><li><a href="#python-df-8">Python DF</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/favicon.ico" alt="Archives Unleashed Toolkit" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/dependencies">Getting Started</a><a href="/docs/collection-analysis">Generating Results</a><a href="/docs/filters-rdd">Filtering results</a><a href="/docs/aut-spark-submit-app">Standard Derivatives</a><a href="/docs/df-results">What to do with Results</a></div><div><h5>Community</h5><a href="https://archivesunleashed.org/get-involved/#newsletter-subscription" target="_blank">Newsletter</a><a href="http://slack.archivesunleashed.org/">Slack</a><a href="https://archivesunleashed.org/events/">Events</a><a href="https://zenodo.org/communities/wahr/">Datasets</a></div><div><h5>More</h5><a href="https://news.archivesunleashed.org/">Project News</a><a href="https://github.com/">GitHub</a><a href="https://twitter.com/unleasharchives" target="_blank">Twitter</a><a href="https://www.youtube.com/channel/UC4Sq0Xi6UWhYK2VbmAzFhAw" target="_blank">YouTube</a></div></section><section class="sitemap"><img alt="Andrew W. Mellon Foundation" class="footer_img" src="/img/mellon.svg"/><img alt="University of Waterloo" class="footer_img" src="/img/waterloo.png"/><img alt="York University" class="footer_img" src="/img/york.png"/></section><section class="copyright">CC BY 2.0 2023 Archives Unleashed Project</section></footer></div></body></html>